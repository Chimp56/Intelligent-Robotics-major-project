# amcl_params.yaml
# AMCL (Adaptive Monte Carlo Localization) parameters for TurtleBot2
# Optimized for indoor navigation with laser scan

amcl:
  # ========================================================================
  # Particle Filter Parameters
  # ========================================================================
  
  min_particles: 500           # Minimum number of particles
  max_particles: 2000         # Maximum number of particles
  kld_err: 0.05              # KLD error parameter
  kld_z: 0.99                # KLD z parameter (confidence level)
  update_min_d: 0.2          # Minimum translation to perform filter update (meters)
  update_min_a: 0.5          # Minimum rotation to perform filter update (radians)
  
  # ========================================================================
  # Laser Model Parameters
  # ========================================================================
  
  laser_min_range: -1.0      # Minimum laser range (meters, -1 = use sensor min)
  laser_max_range: -1.0       # Maximum laser range (meters, -1 = use sensor max)
  laser_max_beams: 60        # Maximum number of beams to use (for efficiency)
  
  # Laser model type: "beam" or "likelihood_field"
  laser_model_type: "likelihood_field"
  
  # Beam model parameters (if using beam model)
  laser_z_hit: 0.95          # Weight for hit component
  laser_z_short: 0.1         # Weight for short reading component
  laser_z_max: 0.05          # Weight for max range component
  laser_z_rand: 0.05         # Weight for random component
  laser_sigma_hit: 0.2       # Standard deviation for hit component (meters)
  laser_lambda_short: 0.1    # Exponential decay parameter for short readings
  laser_likelihood_max_dist: 2.0  # Maximum distance for likelihood field (meters)
  
  # Likelihood field model parameters (if using likelihood_field model)
  laser_likelihood_max_dist: 2.0  # Maximum distance for likelihood field (meters)
  
  # ========================================================================
  # Odometry Model Parameters
  # ========================================================================
  
  odom_model_type: "diff"    # Odometry model: "diff", "omni", "diff-corrected", "omni-corrected"
  
  # Differential drive model parameters
  odom_alpha1: 0.2           # Rotation noise from rotation
  odom_alpha2: 0.2           # Rotation noise from translation
  odom_alpha3: 0.2           # Translation noise from translation
  odom_alpha4: 0.2           # Translation noise from rotation
  odom_alpha5: 0.1           # Translation noise from translation (forward motion)
  
  # Odometry frame
  odom_frame_id: odom        # Odometry frame ID
  base_frame_id: base_link   # Base frame ID
  global_frame_id: map       # Global frame ID
  
  # ========================================================================
  # Initial Pose Parameters
  # ========================================================================
  
  initial_pose_x: 0.0        # Initial pose X (meters)
  initial_pose_y: 0.0        # Initial pose Y (meters)
  initial_pose_a: 0.0       # Initial pose yaw (radians)
  initial_cov_xx: 0.5        # Initial covariance XX
  initial_cov_yy: 0.5        # Initial covariance YY
  initial_cov_aa: 0.5        # Initial covariance AA (orientation)
  
  # ========================================================================
  # Recovery Parameters
  # ========================================================================
  
  recovery_alpha_slow: 0.001  # Exponential decay rate for slow average
  recovery_alpha_fast: 0.1    # Exponential decay rate for fast average
  
  # ========================================================================
  # Resampling Parameters
  # ========================================================================
  
  resample_interval: 1       # Number of filter updates before resampling
  transform_tolerance: 0.1     # Transform tolerance (seconds)
  
  # ========================================================================
  # Laser Scan Parameters
  # ========================================================================
  
  # Laser scan topic
  scan_topic: scan           # Laser scan topic name
  
  # ========================================================================
  # Map Parameters
  # ========================================================================
  
  use_map_topic: true        # Use map topic (vs. service)
  first_map_only: false      # Only use first map received
  
  # ========================================================================
  # Selective Resampling
  # ========================================================================
  
  selective_resampling: true  # Use selective resampling (more efficient)
  
  # ========================================================================
  # TF Parameters
  # ========================================================================
  
  tf_broadcast: true         # Broadcast transform from map to odom
  tf_broadcast_interval: 0.1 # Broadcast interval (seconds)
  
  # ========================================================================
  # TurtleBot2 Specific Tuning
  # ========================================================================
  
  # These parameters are tuned for TurtleBot2 with typical indoor laser scanner
  # (e.g., Hokuyo URG-04LX or simulated Kinect depth-to-laser)
  
  # Laser parameters for typical TurtleBot2 setup
  laser_max_range: 5.0       # Typical max range for indoor navigation (meters)
  laser_z_hit: 0.95          # High confidence in laser hits
  laser_sigma_hit: 0.2       # Reasonable uncertainty for indoor environments
  
  # Odometry parameters for Kobuki base
  # Kobuki has good odometry, so lower noise values
  odom_alpha1: 0.2           # Rotation noise from rotation
  odom_alpha2: 0.2           # Rotation noise from translation
  odom_alpha3: 0.2           # Translation noise from translation
  odom_alpha4: 0.2           # Translation noise from rotation
  odom_alpha5: 0.1           # Forward motion noise (typically lower)
  
  # Particle filter tuning for indoor navigation
  min_particles: 500          # Sufficient for most indoor environments
  max_particles: 2000         # Good balance between accuracy and computation
  kld_err: 0.05              # Standard KLD error
  kld_z: 0.99                # 99% confidence level
  
  # Update thresholds (update when robot moves enough)
  update_min_d: 0.2          # 20cm translation threshold
  update_min_a: 0.5          # ~30 degree rotation threshold
  
  # ========================================================================
  # Advanced Parameters
  # ========================================================================
  
  # Do not resample every update (for efficiency)
  resample_interval: 1       # Resample every update
  
  # Transform settings
  transform_tolerance: 0.1    # 100ms tolerance for transforms
  
  # Recovery behavior
  recovery_alpha_slow: 0.001  # Slow average for recovery
  recovery_alpha_fast: 0.1    # Fast average for recovery

